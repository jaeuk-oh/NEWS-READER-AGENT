content_harvesting_task:
  description: >
    Collect recent news articles based on {topic}.

    Steps:
    1. Break {topic} into 3-4 focused search queries that cover different angles.
      For example, if the topic involves multiple concepts, search each one
      separately with phrasing like:
        - "[key concept A] latest news"
        - "[key concept B] developments 2025"
        - "[key concept A] [key concept B] industry impact"
      Run each query using the search tool. This is critical â€” a single broad
      query will miss important coverage.

    2. From all search results combined, identify URLs from credible sources.

    3. **IMPORTANT: Only select actual article pages, not topic hubs or tag listings**
      Filter out any URLs that are likely to be:
      - Topic/tag/section index pages (URLs containing "/tag/", "/topic/", "/hub/", "/section/", "/category/")
      - Pages with no unique headline or timestamp
      - Pages that only contain a list of other stories or links
      âœ… Acceptable: full articles with a headline, body text, and publication date
      âŒ Reject: https://www.nytimes.com/topic/, https://apnews.com/hub, etc.

    4. For each accepted article URL:
      - Use the scrape tool to extract the full article content
      - Capture: title, source name, publication date, and the **complete article
        body text**. Do not truncate or summarize the content at this stage â€”
        the next stage depends on having the full text.

    5. Filter out:
      - Articles shorter than 200 words
      - Articles older than 48 hours (unless specifically relevant to ongoing developments)
      - Pages that failed to scrape or returned no substantial content

    6. If fewer than 5 articles pass filtering, run additional searches with
      different phrasings before finalizing.

    7. Classify each article into a topic category (e.g. AI/ML, Industry & Business,
      Policy & Regulation, Technology, Research, etc.)

    8. Score each article:
      - Credibility (1-10): based on source reputation and content quality
      - Relevance (1-10): based on how well it matches {topic}

  expected_output: >
    A well-structured markdown document. Articles ordered by Relevance Score descending:

    # News Articles Collection: {topic}

    **Collection Summary**
    - Total articles found:
    - Articles after filtering:
    - Duplicates removed:
    - Sources accessed:
    - Search queries used:
    - Search timestamp:

    ---

    ## Article 1: [Article Headline]

    **Source:**
    **Date:**
    **URL:**
    **Category:**
    **Credibility Score:**
    **Relevance Score:**

    **Content:**
    [Full article body text here â€” do not truncate]

    ---

    [Repeat for all articles, ordered by Relevance Score descending]

  agent: news_hunter_agent
  markdown: true
  output_file: output/content_harvest.md
  create_directory: true

summarization_task:
  description: >
    Summarize each article collected by the previous task into three tiers.

    Work primarily from the full article content already provided in the harvest
    output. Only use the scrape tool as a fallback if a specific article's content
    is missing or clearly truncated.

    Process articles in order of relevance score (highest first).

    For each article, produce:
    1. **Headline Summary** (â‰¤280 characters)
       - Tweet-style, lead with the single most newsworthy element
       - Include key numbers or metrics when available

    2. **Executive Summary** (150â€“200 words)
       - Concise professional briefing
       - Cover: what happened, key players, immediate implications
       - Maintain objectivity â€” present facts, not opinions

    3. **Comprehensive Summary** (400â€“600 words)
       - Full context and background
       - Multiple perspectives where the source provides them
       - Explain technical concepts for a general audience
       - Cover implications and future outlook
       - Do not include any facts not present in the source article

    End each article's section with 3 bullet Key Takeaways â€” the distilled
    essentials a reader must not miss.

  expected_output: >
    A structured markdown document. Articles ordered by relevance score descending:

    # News Summaries: {topic}

    **Summary Report Overview**
    - Total articles processed:
    - Summary generation date:

    ---

    ## Article 1: [Original Headline]

    **Source:**
    **Date:**
    **Original URL:**
    **Credibility Score:**
    **Relevance Score:**

    ### ðŸ“± Headline Summary (Tweet-length)
    [â‰¤280-character summary]

    ### ðŸ“‹ Executive Summary
    [150-200 word professional briefing]

    ### ðŸ“– Comprehensive Summary
    [400-600 word detailed summary with full context]

    **Key Takeaways:**
    - [Most important point]
    - [Second important point]
    - [Third important point]

    ---

    [Repeat for all articles, ordered by relevance score descending]

  agent: summarizer_agent
  markdown: true
  output_file: output/summary.md
  create_directory: true

final_report_assembly_task:
  description: >
    Assemble all summaries into a single cohesive daily news briefing.

    You are producing the FINAL document that will be directly published
    to Notion and distributed via email.

    Assembly rules:

    1. Review all summarized articles along with their credibility and relevance scores.
    2. Select the Lead Story based on the strongest combination of relevance and credibility.
       The lead story MUST use its Comprehensive Summary.
    3. Group remaining stories into logical sections derived naturally from
       the actual content themes. Do NOT invent artificial categories.
    4. For each section:
       - Write a short editorial introduction (2â€“4 sentences) explaining
         why these stories belong together and why they matter.
       - Use Comprehensive Summary for the 1â€“2 most important stories.
       - Use Executive Summary for supporting stories.
    5. Preserve all original source attributions and URLs exactly.
    6. Write an Editor's Analysis section that synthesizes cross-story themes,
       broader implications, and forward-looking insights.
    7. Keep formatting clean, readable, and professional.
       Use standard markdown headings only (##, ###).
       Avoid deeply nested formatting.

    -----------------------------
    CRITICAL OUTPUT INSTRUCTIONS
    -----------------------------

    â€¢ Return ONLY the final markdown document.
    â€¢ Do NOT include explanations, commentary, or meta text.
    â€¢ Do NOT describe what you did.
    â€¢ Do NOT say phrases like:
        - "The above is..."
        - "This report..."
        - "Publication-ready..."
        - "Here is the final document"
        - "Formatted in markdown"
    â€¢ Do NOT wrap the output in code fences.
    â€¢ Begin immediately with:

    # Daily News Briefing: {topic}

    The first character of your response must be '#'.

  expected_output: >
    # Daily News Briefing: {topic}

    **Date:** [Current date]
    **Generated:** [Timestamp]
    **Stories Covered:** [Number]

    ---

    ## Executive Summary

    [Opening paragraph explaining the day's most significant developments
    and why they matter in context.]

    ---

    ## ðŸš¨ Lead Story

    ### [Compelling Headline]

    [Comprehensive Summary]

    **Source:** [Publication] | **Read more:** [Link](url)

    ---

    ## [Dynamic Section Heading]

    [Editorial introduction explaining the grouping.]

    ### [Story Headline]
    [Comprehensive or Executive Summary]
    **Source:** [Publication] | **Read more:** [Link](url)

    ### [Story Headline]
    [Comprehensive or Executive Summary]
    **Source:** [Publication] | **Read more:** [Link](url)

    ---

    ## ðŸŽ¯ Editor's Analysis

    **Key Themes Today:**
    - [Theme]
    - [Theme]

    **What This Means:**
    [Implications]

    **Looking Ahead:**
    [Forward view]

    ---

    ## ðŸ“š Further Reading

    - [Related link]
    - [Related link]

  agent: curator_agent
  markdown: true
  output_file: output/final_report.md
  create_directory: true
