content_harvesting_task:
  description: >
    Collect recent news articles based on {topic}.

    Steps:
    1. Break {topic} into 3-4 focused search queries that cover different angles.
      For example, if the topic involves multiple concepts, search each one
      separately with phrasing like:
        - "[key concept A] latest news"
        - "[key concept B] developments 2025"
        - "[key concept A] [key concept B] industry impact"
      Run each query using the search tool. This is critical â€” a single broad
      query will miss important coverage.

    2. From all search results combined, identify URLs from credible sources.

    3. **IMPORTANT: Only select actual article pages, not topic hubs or tag listings**
      Filter out any URLs that are likely to be:
      - Topic/tag/section index pages (URLs containing "/tag/", "/topic/", "/hub/", "/section/", "/category/")
      - Pages with no unique headline or timestamp
      - Pages that only contain a list of other stories or links
      âœ… Acceptable: full articles with a headline, body text, and publication date
      âŒ Reject: https://www.nytimes.com/topic/, https://apnews.com/hub, etc.

    4. For each accepted article URL:
      - Use the scrape tool to extract the full article content
      - Capture: title, source name, publication date, and the **complete article
        body text**. Do not truncate or summarize the content at this stage â€”
        the next stage depends on having the full text.

    5. Filter out:
      - Articles shorter than 200 words
      - Articles older than 48 hours (unless specifically relevant to ongoing developments)
      - Pages that failed to scrape or returned no substantial content

    6. If fewer than 3 articles pass all filters, apply the following fallback
      strategy in order â€” stop as soon as you have at least 3 articles:

      Step A â€” Broader phrasing: strip adjectives/modifiers from the topic
        and search the core concept only.
        e.g. "AI agent latest trends 2025" â†’ "AI agent"

      Step B â€” English equivalent: if the topic contains non-English terms,
        translate them to English and retry with the English version.

      Step C â€” Extended time window: repeat the original queries but accept
        articles up to 7 days old instead of 48 hours.
        Prepend "[older context]" label to any article beyond 48 h.

      If still 0 articles after all three steps, output the harvest document
      with "Articles after filtering: 0" clearly stated in the Collection
      Summary and stop â€” do not fabricate content.

    7. Classify each article into a topic category (e.g. AI/ML, Industry & Business,
      Policy & Regulation, Technology, Research, etc.)

    8. Score each article:
      - Credibility (1-10): based on source reputation and content quality
      - Relevance (1-10): based on how well it matches {topic}

  expected_output: >
    A well-structured markdown document. Articles ordered by Relevance Score descending:

    # News Articles Collection: {topic}

    **Collection Summary**
    - Total articles found:
    - Articles after filtering:
    - Duplicates removed:
    - Sources accessed:
    - Search queries used:
    - Search timestamp:

    ---

    ## Article 1: [Article Headline]

    **Source:**
    **Date:**
    **URL:**
    **Category:**
    **Credibility Score:**
    **Relevance Score:**

    **Content:**
    [Full article body text here â€” do not truncate]

    ---

    [Repeat for all articles, ordered by Relevance Score descending]

  agent: news_hunter_agent
  markdown: true
  output_file: output/content_harvest.md
  create_directory: true

summarization_task:
  description: >
    Summarize each article collected by the previous task into three tiers.

    Work primarily from the full article content already provided in the harvest
    output. Only use the scrape tool as a fallback if a specific article's content
    is missing or clearly truncated.

    Process articles in order of relevance score (highest first).

    For each article, produce:
    1. **Headline Summary** (â‰¤280 characters)
       - Tweet-style, lead with the single most newsworthy element
       - Include key numbers or metrics when available

    2. **Executive Summary** (150â€“200 words)
       - Concise professional briefing
       - Cover: what happened, key players, immediate implications
       - Maintain objectivity â€” present facts, not opinions

    3. **Comprehensive Summary** (400â€“600 words)
       - Full context and background
       - Multiple perspectives where the source provides them
       - Explain technical concepts for a general audience
       - Cover implications and future outlook
       - Do not include any facts not present in the source article

    End each article's section with 3 bullet Key Takeaways â€” the distilled
    essentials a reader must not miss.

  expected_output: >
    A structured markdown document. Articles ordered by relevance score descending:

    # News Summaries: {topic}

    **Summary Report Overview**
    - Total articles processed:
    - Summary generation date:

    ---

    ## Article 1: [Original Headline]

    **Source:**
    **Date:**
    **Original URL:**
    **Credibility Score:**
    **Relevance Score:**

    ### ðŸ“± Headline Summary (Tweet-length)
    [â‰¤280-character summary]

    ### ðŸ“‹ Executive Summary
    [150-200 word professional briefing]

    ### ðŸ“– Comprehensive Summary
    [400-600 word detailed summary with full context]

    **Key Takeaways:**
    - [Most important point]
    - [Second important point]
    - [Third important point]

    ---

    [Repeat for all articles, ordered by relevance score descending]

  agent: summarizer_agent
  markdown: true
  output_file: output/summary.md
  create_directory: true

final_report_assembly_task:
  description: >
    Assemble all summaries into a single cohesive daily news briefing.

    You are producing the FINAL document that will be directly distributed
    via email to subscribers. Target audience is general readers
    who want a clear, scannable briefing.

    Assembly rules:

    1. Review all summarized articles along with their credibility and relevance scores.
    2. Build "Today at a Glance" â€” one bullet per story, each a single sentence
       capturing the core news. This lets readers scan the full briefing in seconds.
    3. Select the Lead Story: pick the article with the highest
       (relevance + credibility) total. On a tie, prefer higher relevance.
       The lead story MUST use its Comprehensive Summary and include
       3 bullet Key Takeaways.
    4. Group remaining stories into logical sections derived naturally from
       the actual content themes. Do NOT invent artificial categories.
    5. For each section:
       - Write a short editorial introduction (2â€“3 sentences) explaining
         why these stories belong together and why they matter.
       - Use Executive Summary ONLY (150â€“200 words) for every non-lead story.
    6. Preserve all original source attributions and URLs exactly.
    7. Write an "Analysis and Outlook" section â€” a single cohesive paragraph
       (200â€“300 words) that synthesizes cross-story themes, broader implications,
       and a forward-looking view. Do NOT split it into sub-sections.
    8. Do NOT include a "Further Reading" section. Source links already appear
       under each story.
    9. Do NOT use emoji in any heading or text.
    10. Keep formatting clean, readable, and professional.
        Use standard markdown headings only (##, ###).
        Avoid deeply nested formatting.

    -----------------------------
    CRITICAL OUTPUT INSTRUCTIONS
    -----------------------------

    â€¢ Return ONLY the final markdown document.
    â€¢ Do NOT include explanations, commentary, or meta text.
    â€¢ Do NOT describe what you did.
    â€¢ Do NOT say phrases like:
        - "The above is..."
        - "This report..."
        - "Publication-ready..."
        - "Here is the final document"
        - "Formatted in markdown"
    â€¢ Do NOT wrap the output in code fences.
    â€¢ Begin immediately with:

    # Daily News Briefing: {topic}

    The first character of your response must be '#'.

  expected_output: >
    # Daily News Briefing: {topic}

    **Date:** [YYYY-MM-DD]
    **Stories Covered:** [Number]

    ---

    ## Today at a Glance

    - [One-line summary of story 1]
    - [One-line summary of story 2]
    - [One-line summary of story 3]
    - ...

    ---

    ## Lead Story

    ### [Headline]

    [Comprehensive Summary â€” 400-600 words]

    **Key Takeaways:**
    - [Point 1]
    - [Point 2]
    - [Point 3]

    **Source:** [Publication] â€” [Link](url)

    ---

    ## [Dynamic Section Heading]

    [2-3 sentence editorial introduction]

    ### [Story Headline]
    [Executive Summary â€” 150-200 words]
    **Source:** [Publication] â€” [Link](url)

    ### [Story Headline]
    [Executive Summary â€” 150-200 words]
    **Source:** [Publication] â€” [Link](url)

    ---

    ## Analysis and Outlook

    [Single cohesive editorial â€” 200-300 words. Synthesizes themes,
    implications, and forward view. No sub-sections.]

    ---

  agent: curator_agent
  markdown: true
  output_file: output/final_report.md
  create_directory: true
